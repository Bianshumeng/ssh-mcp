# SSH MCP 增强版产品需求

最后更新：2026-02-15

## 能力概述

本模块用于让 SSH MCP 从“单一启动目标”升级为“可配置多目标 + 运行时切换 + 备注管理”。

## 关联文档

- 应用流程：`plan/规格/应用流程.md`
- 技术约束：`plan/规格/技术栈约束.md`
- 后端结构：`plan/规格/后端结构.md`
- 任务实施：`plan/2026-02-15_ssh-mcp-配置模板与动态切换/实施计划.md`

## 需求列表

### 需求：保留旧参数模式兼容性

系统必须继续支持 `--host --user --password/--key` 的单目标启动方式。

#### 场景：旧命令直接运行
- 当 用户用旧参数启动服务
- 那么 `exec` 和 `sudo-exec` 的行为与改造前一致

### 需求：支持本地 profile 配置文件

系统必须支持通过 `--config` 加载本地 profile 文件，并校验激活 profile 与认证字段。

#### 场景：读取 profile 配置
- 当 用户提供合法配置文件并启动
- 那么 服务可读取 `activeProfile` 并建立目标连接上下文

### 需求：运行时可切换 profile

系统必须提供 MCP 管理工具用于查看、切换、重载 profile。

#### 场景：切换目标
- 当 用户调用 `profiles-use` 指定 `profileId`
- 那么 服务关闭旧连接并对后续命令使用新 profile

### 需求：备注可维护且可持久化

系统必须允许更新 profile 的 `note`，并写回本地配置文件。

#### 场景：更新备注
- 当 用户调用 `profiles-note-update`
- 那么 指定 profile 的备注被持久化并可在 `profiles-list` 中看到

