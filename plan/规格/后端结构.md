# SSH MCP 增强版后端结构

最后更新：2026-02-15

## 能力概述

后端结构目标是将单文件实现拆分为配置层、profile 生命周期层、连接层、工具层。

## 关联文档

- 产品需求：`plan/规格/产品需求.md`
- 应用流程：`plan/规格/应用流程.md`
- 技术设计：`plan/2026-02-15_ssh-mcp-配置模板与动态切换/技术设计.md`

## 需求列表

### 需求：配置层职责单一

配置读取、ENV 展开、Schema 校验必须集中在 `config` 子模块。

#### 场景：配置加载
- 当 服务启动或重载配置
- 那么 统一由配置加载器输出标准化 profile 数据结构

### 需求：profile 生命周期独立

active profile 选择、切换、重载、备注更新应由 profile 管理器统一负责。

#### 场景：切换 profile
- 当 调用 profile 切换工具
- 那么 连接层收到“会话重建”信号并切换目标

### 需求：工具层可组合

exec/sudo 与 profile 管理工具注册应模块化，避免全部堆叠在入口文件。

#### 场景：工具注册
- 当 初始化 MCP server
- 那么 入口文件仅负责组装依赖与注册

